\section{Introduction}
\label{sec:intro}

Monads quickly became ubiquitous in functional programming because of their ability to structure effectful code in a pure functional codebase \cite{DBLP:conf/lfp/Wadler90}. However, monads have two major drawbacks. First, monads are not trivially extensible. A variety of techniques were developed to resolve this, including monad transformers \cite{DBLP:conf/popl/LiangHJ95}, free monads, and algebraic effects and handlers \cite{DBLP:conf/esop/PlotkinP09}. Second, monadic computations can only be inspected up to the next action. Techniques such as applicative functors \cite{DBLP:journals/jfp/McbrideP08}, arrows \cite{DBLP:journals/scp/Hughes00}, or selective applicative functors \cite{Mokhov:2019:SAF:3352468.3341694} increase the inspection capabilities by reducing the expressivity compared to monads.

This paper develops a domain specific language (DSL) embedded in Haskell for defining micro-animations, called \dsl{}\footnote{Pronounced \textit{pace}, the name is derived from \textit{\textbf{pa}rallel} and \textit{\textbf{se}quential}.}. \dsl{} employs the aforementioned techniques to support its key features: extensibility of operations and inspectability of animations while providing the freedom to express arbitrary animations.

Micro-animations are short animations displayed when users interact with an application, for example an animated transition between two screens. When used appropriately, they aid the user in understanding evolving states of the application \cite{DBLP:conf/infovis/BedersonB99,DBLP:conf/chi/Gonzalez96,DBLP:journals/tvcg/HeerR07}. Examples can be found in almost every software application: window managers shrink minimized windows and move them towards the taskbar, menus in mobile applications pop in gradually, browsers highlight newly selected tabs with an animation, etc.

This paper develops a DSL which combines various features expected of animation libraries, by building them on top of recent ideas found in functional programming. More concretely, our contributions are as follows:
\begin{itemize}
\item We develop \dsl{} which supports correct interactions for expressing arbitrary animations and inspectability. Animation libraries, such as the GreenSock Animation Platform (GSAP)\footnote{\url{https://greensock.com}}, typically use callbacks as a means of extensibility/expressivity which is detrimental to inspectability. We show an example where this results in unexpected behaviour, and how to correct it.
\item We extend and develop \dsl{} as an example of an \emph{extensible} DSL, in the sense that operations can be freely added. While there is a variety of literature on approaches to extensibility, there is not much literature devoted to use cases.
\item Animations in \dsl{} can be specified in an \emph{inspectable} manner, in the sense that information is obtained from a computation without running it. While inspectability has been studied for specific types of computations, such as free applicative functors \cite{DBLP:journals/corr/CapriottiK14}, it is a novel aspect to combine it with extensibility.
\item \dsl{} contains a primitive for parallel animation composition. This composition form can be arbitrarily nested and embedded anywhere within an animation and interacts correctly with the other features of \dsl{}: extensibility and inspectability. Parallel components in sequentially specified components is not new, see for example the \emph{par} element in UML sequence diagrams \cite{umlspec}, or the parallel statement in Ren'Py\footnote{\url{https://www.renpy.org/doc/html/atl.html\#parallel-statement}} or React Native Animations\footnote{\url{https://facebook.github.io/react-native/docs/animated\#parallel}}. But, those systems either do not provide a form of parallelism as general or interaction with other features such as inspectability is not present.
\end{itemize}
