\section{Introduction}
\label{sec:intro}

Monads have become ubiquitous since they were made popular in functional programming \cite{DBLP:conf/lfp/Wadler90}. However, while monads are useful for structuring effectful code in a pure functional codebase, they do carry certain drawbacks. First, monads are not trivially extensible. A variety of techniques have been developed to resolve this, including monad transformers \cite{DBLP:conf/popl/LiangHJ95}, free monads, and algebraic effects and handlers \cite{DBLP:conf/esop/PlotkinP09}. Second, monadic computations can only be inspected up to the next action. Techniques such as applicative functors \cite{DBLP:journals/jfp/McbrideP08}, arrows \cite{DBLP:journals/scp/Hughes00}, or selective applicative functors \cite{Mokhov:2019:SAF:3352468.3341694} increase the inspection capabilities by reducing the expressivity of our computations.

This paper develops a domain specific language (DSL) embededd in Haskell for defining micro-animations, called \dsl{}\footnote{Pronounced \textit{pace}, the name is derived from \textit{\textbf{pa}rallel} and \textit{\textbf{se}quential}.}. \dsl{} employs the aforementioned techniques to support its key features: extensibility of operations, inspectability of animations while maintaining the necessary expressivity.

Micro-animations, of which animated transitions are a subset, are short animations displayed when users interact with an application. When used appropriately, they aid the user in understanding evolving states of the application \cite{DBLP:conf/infovis/BedersonB99} \cite{DBLP:conf/chi/Gonzalez96} \cite{DBLP:journals/tvcg/HeerR07}. Examples can be found in almost every software application: window managers shrink minimized windows and move them towards the taskbar, menus in mobile applications pop in gradually, browsers highlight newly selected tabs with an animation, \ldots

Our contributions are as follows:
\begin{itemize}
\item The philosophy of \dsl{} is to decompose animations into sequential and parallel elements. The idea of parallel elements in sequentially specified components is not new, see for example the \emph{par} element in UML sequence diagrams \cite{umlspec}, or the parallel statement in Ren'Py\footnote{\url{https://www.renpy.org/doc/html/atl.html#parallel-statement}} or React Native Animations\footnote{\url{https://facebook.github.io/react-native/docs/animated#parallel}}. But, we present a general form of parallel composition and its interaction with the extensibility and inspectability features, which are not present in those systems.
\item We extend and develop \dsl{} as an example of an \emph{extensible} DSL, in the sense that operations can be freely added. While there is a variety of literature on approaches to extensibility, there is not many literature devoted to use cases.
\item Animations in \dsl{} can be specified in an \emph{inspectable} manner, in the sense that information can be obtained from a computation without running it. While inspectability has been studied for specific types of computations, such as free applicative functors \cite{DBLP:journals/corr/CapriottiK14}, it is a novel aspect to combine it with the extensibility aspect of \dsl{}.
\item Many animation libraries provide a basic form of parallel composition and leave it up to the user to develop more complex forms of parallel animations, for example based on callbacks. We argue for the addition of parallel composition as a foundational element to an animation library, to be able to correctly support the combination of features present in \dsl{}.
\end{itemize}
